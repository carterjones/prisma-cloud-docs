== AWS Security Group allows unrestricted egress traffic

=== Policy Details

[width=45%]
[cols="1,1"]
|===
|Prisma Cloud Policy ID
| TBD

|Checkov ID
| https://github.com/bridgecrewio/checkov/blob/main/checkov/terraform/checks/resource/aws/SecurityGroupUnrestrictedEgressAny.py[CKV_AWS_382]

|Severity
|LOW

|Subtype
|Build

|Frameworks
|Terraform,Terraform Plan

|===

=== Description

This policy identifies AWS Security Groups that allow unrestricted egress traffic. Allowing unrestricted outbound traffic can lead to data exfiltration and other security risks. As a best practice, egress rules should be explicitly defined to limit outbound traffic to known, trusted destinations.

=== Fix - Buildtime

*Terraform*

* *Resource:* aws_security_group
* *Arguments:* egress

To fix this issue, ensure that the `egress` block in your Terraform configuration is explicitly defined with restricted outbound traffic rules.

[source,go]
----
resource "aws_security_group" "example" {
  ...
-  egress {
-    from_port   = 0
-    to_port     = 0
-    protocol    = "-1"
-    cidr_blocks = ["0.0.0.0/0"]
-  }

+  egress {
+    from_port   = 443
+    to_port     = 443
+    protocol    = "tcp"
+    cidr_blocks = ["10.0.0.0/16"]  # Restrict to known, trusted destination
+  }
}
----
