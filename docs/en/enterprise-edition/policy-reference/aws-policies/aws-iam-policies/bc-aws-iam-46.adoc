== AWS SQS queue access policy is overly permissive


=== Policy Details 

[width=45%]
[cols="1,1"]
|=== 
|Prisma Cloud Policy ID 
| bfe88196-dc6b-4c34-bda7-ef4b90942544

|Checkov ID 
| https://github.com/bridgecrewio/checkov/tree/main/checkov/terraform/checks/resource/aws/SQSPolicy.py[CKV_AWS_72]

|Severity
|INFO

|Subtype
|Build, Run

|Frameworks
|Terraform,TerraformPlan

|=== 



=== Description 

This policy ensures that AWS SQS policies do not allow unrestricted (*) actions. Allowing all actions in a policy can expose your SQS queue to potential misuse or unauthorized access, posing a security risk. Restricting the actions to only those required for your application ensures adherence to the principle of least privilege.


=== Fix - Buildtime


*Terraform* 


* *Arguments:* aws_sqs_queue_policy
* *Attribute*: policy.Statement.Action


[source,go]
----
resource "aws_sqs_queue_policy" "example" {
  ...

  policy = <<POLICY
    {
      ...
      "Statement": [
        {
          "Sid": "Example",
          "Effect": "Allow",
-          "Action"   = "*",
+          "Action": ["sqs:SendMessage"],
          ...
        }
      ]
    }
  POLICY
}
----
