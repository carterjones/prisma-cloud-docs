== Docker Swarm Unlock Key detected in code


=== Policy Details

[width=45%]
[cols="1,1"]
|===
|Prisma Cloud Policy ID
|d5e0d330-7893-47c0-8d13-ae5150b6916f

|Checkov Check ID
|CKV_SECRET_171

|Severity
|HIGH

|Subtype
|Build

|Frameworks
|Git

|===


=== Description

The Docker Swarm Unlock Key is a critical credential used to unlock encrypted data stored in Docker Swarm, ensuring the security and integrity of your container orchestration. Exposing this key can lead to unauthorized access, allowing malicious actors to manipulate your containers and services, potentially causing severe operational disruptions and data breaches. To maintain the security of your Docker Swarm environment, it is essential to manage your Unlock Key securely and regularly review your security practices to prevent any unauthorized usage. For comprehensive security guidelines and best practices regarding Docker Swarm Unlock Key management, refer to the latest documentation and support resources available in the https://docs.docker.com/engine/swarm/manage-nodes/#unlock-a-swarm[Docker documentation and support].

=== Fix - Buildtime

*Docker Swarm*

If your Docker Swarm Unlock Key is exposed, it's crucial to take immediate action to prevent any unauthorized use. Regenerate a new Unlock Key through your Docker Swarm management interface and replace the exposed key with the new key in all relevant configurations. By regenerating a compromised Docker Swarm Unlock Key and updating your configurations, you not only secure your container orchestration environment but also maintain the confidentiality and integrity of your services.

1. Log into your Docker Swarm manager node with administrator credentials.

2. Use the command `docker swarm unlock-key --rotate` to generate a new Unlock Key.

3. Save the new key securely and ensure it is not hardcoded in your source code or exposed in public repositories.

4. Update all relevant Docker Swarm configurations and services with the new Unlock Key values.

5. Ensure all nodes in the Docker Swarm are updated with the new Unlock Key to maintain synchronization and security.

After updating the key, it is recommended to audit all recent activities in your Docker Swarm environment to detect any unauthorized access or unusual activities. This will help you assess the impact of the exposure and enhance your security measures.
