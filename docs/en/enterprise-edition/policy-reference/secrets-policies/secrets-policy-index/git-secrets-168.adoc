== Salesforce Refresh Token detected in code


=== Policy Details

[width=45%]
[cols="1,1"]
|===
|Prisma Cloud Policy ID
|9197c19b-d821-4783-a070-fd5e3f2ec35c

|Checkov Check ID
|CKV_SECRET_168

|Severity
|MEDIUM

|Subtype
|Build

|Frameworks
|Git

|===


=== Description

The Salesforce Refresh Token is a critical credential used to obtain new access tokens without requiring the user to log in again, allowing seamless integration and continuous access to Salesforce APIs. Exposing this token can lead to unauthorized access to your Salesforce account, potentially compromising sensitive business data and disrupting operations. To ensure the security of your Salesforce integration, it is essential to manage your Refresh Token securely and regularly review your security practices to prevent any unauthorized usage. For comprehensive security guidelines and best practices regarding Salesforce Refresh Token management, refer to the latest documentation and support resources available in the https://help.salesforce.com/articleView?id=remoteaccess_oauth_refresh_token_flow.htm[Salesforce documentation and support].

=== Fix - Buildtime

*Salesforce*

If your Salesforce Refresh Token is exposed, it's crucial to take immediate action to prevent any unauthorized use. Revoke the compromised token through your Salesforce account and generate a new token to replace the exposed one in all relevant applications. By revoking a compromised Salesforce Refresh Token and updating your application integrations, you not only secure your Salesforce API access but also maintain the confidentiality and integrity of your business data.

1. Log into your Salesforce account with administrator credentials.

2. Navigate to 'Setup' and select 'Connected Apps' under 'App Manager'.

3. Identify the connected app using the exposed Refresh Token and revoke the compromised token.
NOTE: Ensure that revoking your token does not disrupt any critical services.

4. Generate a new Refresh Token by reauthorizing the connected app. Save the new token securely.

5. Update all applications and services that use the Salesforce Refresh Token with the new token values, ensuring the new token is not exposed in public repositories or hardcoded in your source code.

After updating the token, it is recommended to audit all recent uses of the Salesforce Refresh Token to detect any unauthorized access or unusual activities. This will help you assess the impact of the exposure and enhance your security measures.
