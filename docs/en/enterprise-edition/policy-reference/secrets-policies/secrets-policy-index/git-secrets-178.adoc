== Azure Subscription Key detected in code


=== Policy Details

[width=45%]
[cols="1,1"]
|===
|Prisma Cloud Policy ID
|8f174056-eb7a-408d-ab65-ac9bcb2ae529

|Checkov Check ID
|CKV_SECRET_178

|Severity
|HIGH

|Subtype
|Build

|Frameworks
|Git

|===


=== Description

The Azure Subscription Key is a critical credential used to access various Azure services and APIs. Exposing this key can lead to unauthorized access, enabling malicious actors to misuse your Azure resources and potentially causing significant operational and financial impacts. To maintain the security of your Azure integration, it is essential to manage your Subscription Key securely and regularly review your security practices to prevent any unauthorized usage. For comprehensive security guidelines and best practices regarding Azure Subscription Key management, refer to the latest documentation and support resources available in the https://docs.microsoft.com/en-us/azure/azure-subscription-service-limits[Azure documentation and support].

=== Fix - Buildtime

*Azure*

If your Azure Subscription Key is exposed, it's crucial to take immediate action to prevent any unauthorized use. Regenerate a new key through your Azure account and replace the exposed key with the new key in all relevant applications. By regenerating a compromised Azure Subscription Key and updating your application integrations, you not only secure your access to Azure services but also maintain the confidentiality and integrity of your cloud resources.

1. Leverage one of the methods in the https://learn.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage?tabs=azure-portal#manually-rotate-access-keys[documentation] to revoke the access key.
NOTE: Ensure that regenerating your key does not disrupt any applications or services.

2. Generate and save the new key securely and ensure it is not hardcoded in your source code or exposed in public repositories.

3. Update all applications and services that use the Azure Subscription Key with the new key values.

After updating the key, it is recommended to audit all recent uses of the Azure Subscription Key to detect any unauthorized access or unusual activities. This will help you assess the impact of the exposure and enhance your security measures.
